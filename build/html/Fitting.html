
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitting &#8212; Horace 3.5.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Herbert" href="Herbert.html" />
    <link rel="prev" title="Developer information" href="Developer_information.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="fitting">
<h1>Fitting<a class="headerlink" href="#fitting" title="Permalink to this headline">¶</a></h1>
<p>Horace comes with a rich and powerful fitting syntax that is common to the methods used to fit functions or models of S(Q,w) to one or more datasets. For an introduction and overview of how to use the following fitting functions, please read <a class="reference internal" href="Multifit.html#multifit"><span class="std std-ref">Fitting data</span></a>. For comprehensive help, please use the Matlab documentation for the various fitting functions that can be obtained by using the <code class="docutils literal notranslate"><span class="pre">doc</span></code> command, for example <code class="docutils literal notranslate"><span class="pre">doc</span> <span class="pre">d1d/multifit</span></code> (for fitting function like Gaussians to d1d objects) or <code class="docutils literal notranslate"><span class="pre">doc</span> <span class="pre">sqw/multifit_sqw</span></code> (fitting models for S(Q,w) to sqw objects). It is strongly recommended that you use <code class="docutils literal notranslate"><span class="pre">doc</span></code>, not <code class="docutils literal notranslate"><span class="pre">help</span></code> to explore how to use these methods, so that you can navigate between the numerous pages of documentation in the Matlab help window.</p>
<p>Several multifit variants are available for sqw and d1d,d2d,…d4d objects. The only substantive difference is the form of the fit functions they require: either they are functions of the numeric values of the plot coordinates, or they are function of wave vector in reciprocal lattice units and energy.</p>
<div class="section" id="multifit">
<h2>multifit<a class="headerlink" href="#multifit" title="Permalink to this headline">¶</a></h2>
<p>This is identical to <code class="docutils literal notranslate"><span class="pre">multifit_func</span></code>)
The foreground and background functions both are functions of the plot axes x1,x2,…for as many x arrays as there are plot axes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">my_function</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="o">...</span> <span class="p">,</span><span class="n">xn</span><span class="p">,</span><span class="n">pars</span><span class="p">)</span>
</pre></div>
</div>
<p>or, more generally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">my_function</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="o">...</span> <span class="p">,</span><span class="n">xn</span><span class="p">,</span><span class="n">pars</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>where
- x1,x2,.xn Arrays of x coordinates along each of the n dimensions
- pars Parameters needed by the function
- c1,c2,… Any further constant arguments needed by the function. For example, they could be the filenames of lookup tables</p>
</div>
<div class="section" id="multifit-sqw">
<h2>multifit_sqw<a class="headerlink" href="#multifit-sqw" title="Permalink to this headline">¶</a></h2>
<p>The foreground function(s) are functions of S(Q,w), and the background functions are functions of the plot axes x1,x2,…</p>
<p>The general form of a model for S(Q,w) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">sqwfunc</span> <span class="p">(</span><span class="n">qh</span><span class="p">,</span><span class="n">qk</span><span class="p">,</span><span class="n">ql</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>or, more generally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">sqwfunc</span> <span class="p">(</span><span class="n">qh</span><span class="p">,</span><span class="n">qk</span><span class="p">,</span><span class="n">ql</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="o">..</span><span class="p">)</span>
</pre></div>
</div>
<p>where
- qh,qk,ql,en Arrays containing the coordinates of a set of points
- p Vector of parameters needed by the model e.g. [A,js,gam] as intensity, exchange, lifetime
- c1,c2,… Other constant parameters e.g. file name for look-up table
- weight Array containing calculated spectral weight</p>
<p>The form for the background model(s) is the same as is required by <code class="docutils literal notranslate"><span class="pre">multifit</span></code>.</p>
</div>
<div class="section" id="multifit-sqw-sqw">
<h2>multifit_sqw_sqw<a class="headerlink" href="#multifit-sqw-sqw" title="Permalink to this headline">¶</a></h2>
<p>The foreground and background function(s) are all functions of S(Q,w). The form of these models is the same as is required by <code class="docutils literal notranslate"><span class="pre">multifit_sqw</span></code>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Horace</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="The_Horace_Rationale.html">The Horace Rationale</a></li>
<li class="toctree-l1"><a class="reference internal" href="Download_and_setup.html">Download and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support_and_updates.html">Support and updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advanced_use.html">Advanced use</a></li>
<li class="toctree-l1"><a class="reference internal" href="Horace_GUI.html">Horace GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changing_Horace_settings.html">Changing Horace settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="Planning_a_Horace_scan.html">Planning a Horace scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generating_SQW_files.html">Generating SQW files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manipulating_and_extracting_data_from_SQW_files_and_objects.html">Manipulating and extracting data from SQW files and objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Correcting_for_sample_misalignment.html">Correcting for sample misalignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_diagnostics.html">Data diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Symmetrising_etc.html">Symmetrising etc</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unary_operations.html">Unary operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Binary_operations.html">Binary operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="Simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Multifit.html">Multifit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tobyfit.html">Tobyfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="List_of_functions.html">List of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input_file_formats.html">Input file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example_scripts.html">Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="How_to_cite_Horace.html">How to cite Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="Papers_citing_Horace.html">Papers citing Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="Known_bugs.html">Known bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Become_a_developer.html">Become a developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="For_Developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer_info.html">Developer info</a></li>
<li class="toctree-l1"><a class="reference internal" href="General_disclaimer.html">General disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Privacy_policy.html">Privacy Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changing_object_type.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer_information.html">\</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">\</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#multifit">multifit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multifit-sqw">multifit_sqw</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multifit-sqw-sqw">multifit_sqw_sqw</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Herbert.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Horace_and_Libisis_installation.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Horace_command_line.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="New.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Official_download_v1.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Read_or_write_to_disk.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Remote_data_analysis.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reshaping_etc.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_inspector.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_correcting_sample_misalignment.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_data_treatment.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_fitting.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_generating_sqw_files.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_making_cuts_and_plotting.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_making_publication_quality_figures.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_making_simulations.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="Script_for_planning_an_experiment.html">\</a></li>
<li class="toctree-l1"><a class="reference internal" href="s_new.html">\</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Developer_information.html" title="previous chapter">Developer information</a></li>
      <li>Next: <a href="Herbert.html" title="next chapter">Herbert</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Alex Buts, Toby Perring, Nick Battam, Harry Saunders, Duc Le, Chris Marooney.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/Fitting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>